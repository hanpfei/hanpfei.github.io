<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









  
  
  <link rel="stylesheet" media="all" href="/lib/Han/dist/han.min.css?v=3.3">




<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.0.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/freesoft.jpg?v=6.0.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/freesoft.jpg?v=6.0.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/freesoft.jpg?v=6.0.3">


  <link rel="mask-icon" href="/images/freesoft.jpg?v=6.0.3" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '6.0.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  
  <meta name="keywords" content="网络协议,HTTP2,翻译," />


<meta name="description" content="摘要本文档描述了一种用于应用层协议协商的 传输层安全 (TLS) 扩展。这允许应用层协商在安全连接上应该执行的协议。">
<meta property="og:type" content="article">
<meta property="og:title" content="传输层安全(TLS)下一个协议协商(NPN)扩展">
<meta property="og:url" content="https://www.wolfcstech.com/2016/10/29/npn-spec/index.html">
<meta property="og:site_name" content="WolfcsTech">
<meta property="og:description" content="摘要本文档描述了一种用于应用层协议协商的 传输层安全 (TLS) 扩展。这允许应用层协商在安全连接上应该执行的协议。">
<meta property="og:updated_time" content="2017-02-21T05:02:16.756Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="传输层安全(TLS)下一个协议协商(NPN)扩展">
<meta name="twitter:description" content="摘要本文档描述了一种用于应用层协议协商的 传输层安全 (TLS) 扩展。这允许应用层协商在安全连接上应该执行的协议。">






  <link rel="canonical" href="https://www.wolfcstech.com/2016/10/29/npn-spec/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>
  <title>传输层安全(TLS)下一个协议协商(NPN)扩展 | WolfcsTech</title>
  




<script async src="https://www.googletagmanager.com/gtag/js?id=UA-109419024-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-109419024-1');
</script>



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?3c736b12c32c019fd9ff6c825b6b9b44";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">WolfcsTech</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签</a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-user"></i> <br />关于</a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="http://www.ixirong.com/404.html" rel="section">
            <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />公益 404</a>
        </li>
      

      
    </ul>
  

  
</nav>


  



 </div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.wolfcstech.com/2016/10/29/npn-spec/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Han Pengfei">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/freesoft.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WolfcsTech">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">传输层安全(TLS)下一个协议协商(NPN)扩展</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-29T13:48:49+08:00">2016-10-29</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/网络协议/" itemprop="url" rel="index"><span itemprop="name">网络协议</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/10/29/npn-spec/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2016/10/29/npn-spec/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2016/10/29/npn-spec/" class="leancloud_visitors" data-flag-title="传输层安全(TLS)下一个协议协商(NPN)扩展">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        <h1 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h1><p>本文档描述了一种用于应用层协议协商的 传输层安全 (TLS) 扩展。这允许应用层协商在安全连接上应该执行的协议。</p>
<a id="more"></a>
<h1 id="Status-of-this-Memo"><a href="#Status-of-this-Memo" class="headerlink" title="Status of this Memo"></a>Status of this Memo</h1><p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at <a href="http://datatracker.ietf.org/drafts/current/" target="_blank" rel="external">http://datatracker.ietf.org/drafts/current/</a>.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as “work in progress.”</p>
<p>This Internet-Draft will expire on October 31, 2012.</p>
<h1 id="Copyright-Notice"><a href="#Copyright-Notice" class="headerlink" title="Copyright Notice"></a>Copyright Notice</h1><p>Copyright (c) 2012 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust’s Legal Provisions Relating to IETF Documents (<a href="http://trustee.ietf.org/" target="_blank" rel="external">http://trustee.ietf.org/</a> license-info) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>
<h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><h2 id="1-简介"><a href="#1-简介" class="headerlink" title="1. 简介"></a>1. 简介</h2><h2 id="2-要求表示法"><a href="#2-要求表示法" class="headerlink" title="2. 要求表示法"></a>2. 要求表示法</h2><h2 id="3-下一个协议协商-扩展"><a href="#3-下一个协议协商-扩展" class="headerlink" title="3. 下一个协议协商 扩展"></a>3. 下一个协议协商 扩展</h2><h2 id="4-协议选择"><a href="#4-协议选择" class="headerlink" title="4. 协议选择"></a>4. 协议选择</h2><h2 id="5-设计讨论"><a href="#5-设计讨论" class="headerlink" title="5. 设计讨论"></a>5. 设计讨论</h2><h2 id="6-安全性注意事项"><a href="#6-安全性注意事项" class="headerlink" title="6. 安全性注意事项"></a>6. 安全性注意事项</h2><h2 id="7-IANA注意事项"><a href="#7-IANA注意事项" class="headerlink" title="7. IANA注意事项"></a>7. IANA注意事项</h2><h2 id="8-致谢"><a href="#8-致谢" class="headerlink" title="8. 致谢"></a>8. 致谢</h2><h2 id="9-参考文献"><a href="#9-参考文献" class="headerlink" title="9. 参考文献"></a>9. 参考文献</h2><h3 id="9-1-规范性参考文献"><a href="#9-1-规范性参考文献" class="headerlink" title="9.1. 规范性参考文献"></a>9.1. 规范性参考文献</h3><h3 id="9-2-参考资料"><a href="#9-2-参考资料" class="headerlink" title="9.2. 参考资料"></a>9.2. 参考资料</h3><h2 id="作者地址"><a href="#作者地址" class="headerlink" title="作者地址"></a>作者地址</h2><h1 id="1-简介-1"><a href="#1-简介-1" class="headerlink" title="1. 简介"></a>1. 简介</h1><p>下一个协议协商 (NPN) 扩展当前被用于对443端口上的应用层协议SPDY [spdy]的使用的协商，并执行SPDY版本协商。然而，它也不是只能用在SPDY中。</p>
<p>新的应用层协议的设计者面临着一个问题：没有一种好的选项来为新协议建立一个干净的传输，并协商对它的使用。端口80上的协商将与拦截代理相冲突。80和443之外的其它端口可能被防火墙屏蔽，没有任何快速的检测方法，也不太可能通过CONNECT穿越HTTP代理。443端口上的协商是可能的，但可能与MITM相冲突，而且也要在建立TLS连接的网络往返的基础上为协商而使用一个往返。在那一层的协商还要依赖于应用层协议，比如，服务器对HTTP Upgrade请求的真实世界容忍</p>
<p>下一个协议协商 允许在没有额外的网络往返的情况下协商应用层协议，并且在不支持的MITM代理的情况下具有干净的回退。</p>
<h1 id="2-要求表示法-1"><a href="#2-要求表示法-1" class="headerlink" title="2.  要求表示法"></a>2.  要求表示法</h1><p>本文档中的关键词 “MUST”，”MUST NOT”，”REQUIRED”，”SHALL”，”SHALL NOT”，”SHOULD”，”SHOULD NOT”，”RECOMMENDED”，”MAY”，和”OPTIONAL” 如RFC 2119 [RFC2119] 中所述那样解释。</p>
<h1 id="3-下一个协议协商扩展"><a href="#3-下一个协议协商扩展" class="headerlink" title="3. 下一个协议协商扩展"></a>3. 下一个协议协商扩展</h1><p>一个新的扩展类型 <code>(&quot;next_protocol_negotiation(TBD)&quot;)</code> 被定义出来了，它 <strong>可以(MAY)</strong> 被客户端包含在它的<code>&quot;ClientHello&quot;</code>消息中。当且仅当，服务器在 <code>&quot;ClientHello&quot;</code> 中看到了这个扩展，它 <strong>可以(MAY)</strong> 在它的 <code>&quot;ServerHello&quot;</code> 中选择回显该扩展。</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">enum</span> &#123;</span></div><div class="line">   next_protocol_negotiation(TBD), (<span class="number">65535</span>)</div><div class="line">&#125; ExtensionType;</div></pre></td></tr></table></figure>
<p><code>&quot;ClientHello&quot;</code> 中 <code>&quot;next_protocol_negotiation&quot;</code> 扩展的 <code>&quot;extension_data&quot;</code> 字段 <strong>必须(MUST)</strong> 是空的。</p>
<p><code>&quot;ServerHello&quot;</code> 中 <code>&quot;next_protocol_negotiation&quot;</code> 扩展的 <code>&quot;extension_data&quot;</code> 字段包含一个可选的由服务器发布的协议的列表。协议的名字是不透明的，非空的字节串，</p>
<p>The “extension_data” field of a “next_protocol_negotiation” extension in a “ServerHello” contains an optional list of protocols advertised by the server.  Protocols are named by opaque, non-empty byte strings and the list of protocols is serialized as a concatenation of 8-bit, length prefixed byte strings.  Implementations MUST ensure that the empty string is not included and that no byte strings are truncated.</p>
<p>A new handshake message type (“encrypted_extensions(TBD)”) is defined.  If the server included a “next_protocol_negotiation” extension in its “ServerHello” message, the client MUST send a “EncryptedExtensions” message after its “ChangeCipherSpec” and before its “Finished” message.</p>
<p>   enum {<br>     encrypted_extensions(TBD), (65535)<br>   } HandshakeType;</p>
<p>Therefore a full handshake with “EncryptedExtensions” has the following flow (contrast with section 7.3 of RFC 5246 [RFC5246]):</p>
<figure class="highlight elm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="type">Client</span>                                               <span class="type">Server</span></div><div class="line"></div><div class="line"><span class="type">ClientHello</span> (<span class="type">NPN</span> extension)   <span class="comment">--------&gt;</span></div><div class="line">                                                <span class="type">ServerHello</span></div><div class="line">                                                  (<span class="type">NPN</span> extension &amp;</div><div class="line">                                                   list <span class="keyword">of</span> protocols)</div><div class="line">                                               <span class="type">Certificate</span>*</div><div class="line">                                         <span class="type">ServerKeyExchange</span>*</div><div class="line">                                        <span class="type">CertificateRequest</span>*</div><div class="line">                             &lt;-<span class="comment">-------      ServerHelloDone</span></div><div class="line"><span class="type">Certificate</span>*</div><div class="line"><span class="type">ClientKeyExchange</span></div><div class="line"><span class="type">CertificateVerify</span>*</div><div class="line">[<span class="type">ChangeCipherSpec</span>]</div><div class="line"><span class="type">EncryptedExtensions</span></div><div class="line"><span class="type">Finished</span>                     <span class="comment">--------&gt;</span></div><div class="line">                                         [<span class="type">ChangeCipherSpec</span>]</div><div class="line">                             &lt;-<span class="comment">-------             Finished</span></div><div class="line"><span class="type">Application</span> <span class="type">Data</span>             &lt;-<span class="comment">------&gt;     Application Data</span></div></pre></td></tr></table></figure>
<p>An abbreviated handshake with “EncryptedExtensions” has the following flow:</p>
<figure class="highlight elm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="type">Client</span>                                                <span class="type">Server</span></div><div class="line"></div><div class="line"><span class="type">ClientHello</span> (<span class="type">NPN</span> extension)    <span class="comment">--------&gt;</span></div><div class="line">                                                <span class="type">ServerHello</span></div><div class="line">                                                  (<span class="type">NPN</span> extension &amp;</div><div class="line">                                                   list <span class="keyword">of</span> protocols)</div><div class="line">                                         [<span class="type">ChangeCipherSpec</span>]</div><div class="line">                              &lt;-<span class="comment">-------            Finished</span></div><div class="line">[<span class="type">ChangeCipherSpec</span>]</div><div class="line"><span class="type">EncryptedExtensions</span></div><div class="line"><span class="type">Finished</span>                      <span class="comment">--------&gt;</span></div><div class="line"><span class="type">Application</span> <span class="type">Data</span>              &lt;-<span class="comment">------&gt;    Application Data</span></div></pre></td></tr></table></figure>
<p>The “EncryptedExtensions” message contains a series of “Extension” structures (see section 7.4.1.4 of RFC 5246 [RFC5246]</p>
<p>If the server included a “next_protocol_negotiation” extension in its “ServerHello” message, the client MUST include an “Extension” with “extension_type” equal to “next_protocol_negotiation(TBD)”.  The “extension_data” of which has the following format:</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">struct &#123;</div><div class="line">   opaque selected_protocol&lt;<span class="number">0.</span><span class="number">.255</span>&gt;;</div><div class="line">   opaque padding&lt;<span class="number">0.</span><span class="number">.255</span>&gt;;</div><div class="line">&#125; NextProtocolNegotiationEncryptedExtension;</div></pre></td></tr></table></figure>
<p>The contents of “selected_protocol” are an opaque protocol string, but need not have been advertised by the server.  The length of “padding” SHOULD be 32 - ((len(selected_protocol) + 2) % 32). Note that len(selected_protocol) does not include its length prefix.</p>
<p>Unlike many other TLS extensions, this extension does not establish properties of the session, only of the connection.  When session resumption or session tickets [RFC5077] are used, the previous contents of this extension are irrelevant and only the values in the new handshake messages are considered.</p>
<p>For the same reasons, after a handshake has been performed for a given connection, renegotiations on the same connection MUST NOT include the “next_protocol_negotiation” extension.</p>
<h1 id="4-协议选择-1"><a href="#4-协议选择-1" class="headerlink" title="4. 协议选择"></a>4. 协议选择</h1><p>It’s expected that a client will have a list of protocols that it supports, in preference order, and will only select a protocol if the server supports it.  In that case, the client SHOULD select the first protocol advertised by the server that it also supports.  In the event that the client doesn’t support any of server’s protocols, or the server doesn’t advertise any, it SHOULD select the first protocol that it supports.</p>
<p>There may be cases where the client knows, via other means, that a server supports an unadvertised protocol.  In these cases the client can simply select that protocol.</p>
<h1 id="5-设计讨论-1"><a href="#5-设计讨论-1" class="headerlink" title="5. 设计讨论"></a>5. 设计讨论</h1><p>NPN is an outlier from TLS in several respects: firstly that it introduces a handshake message between the “ChangeCipherSpec” and “Finished” message, that the handshake message is padded, and that the negotiation isn’t done purely with the hello messages.  All these aspects of the protocol are intended to prevent middle-ware discrimination based on the negotiated protocol and follow the general principle that anything that can be encrypted, should be encrypted.  The server’s list of advertised protocols is in the clear as a compromise between performance and robustness.</p>
<h1 id="6-安全性注意事项-1"><a href="#6-安全性注意事项-1" class="headerlink" title="6. 安全性注意事项"></a>6. 安全性注意事项</h1><p>通过这个扩展，服务器支持的协议的列表依然是明文发布的。</p>
<p>The server’s list of supported protocols is still advertised in the clear with this extension.  This may be undesirable for certain protocols (such as Tor [tor]) where one could imagine that hostile networks would terminate any TLS connection with a server that advertised such a capability.  In this case, clients may wish to opportunistically select a protocol that wasn’t advertised by the server.  However, the workings of such a scheme are outside the scope of this document.</p>
<h1 id="7-IANA注意事项-1"><a href="#7-IANA注意事项-1" class="headerlink" title="7. IANA注意事项"></a>7. IANA注意事项</h1><p>本文档需要IANA更新它的 TLS扩展 注册表，以分配此处称为 <code>&quot;next_protocol_negotiation&quot;</code> 的条目。</p>
<p>本文档还要求IANA更新它的TLS 握手类型注册表，以分配此处称为 <code>&quot;encrypted_extensions&quot;</code> 的条目。</p>
<p>本文档还要求IANA以先到先得的方式创建一个TLS 下一个协议协商 协议字符串 注册表，其中初始包含下面的条目：</p>
<ul>
<li>“http/1.1”：HTTP/1.1 [RFC2616]</li>
<li>“spdy/1”：(废弃的) SPDY 版本 1</li>
<li>“spdy/2”：SPDY 版本 2</li>
<li>“spdy/3”：SPDY 版本 3</li>
</ul>
<h1 id="8-鸣谢"><a href="#8-鸣谢" class="headerlink" title="8. 鸣谢"></a>8. 鸣谢</h1><p>This document benefited specifically from discussions with Wan-Teh Chang and Nagendra Modadugu.</p>
<h1 id="9-参考文献-1"><a href="#9-参考文献-1" class="headerlink" title="9. 参考文献"></a>9. 参考文献</h1><h2 id="9-1-规范性参考文献-1"><a href="#9-1-规范性参考文献-1" class="headerlink" title="9.1. 规范性参考文献"></a>9.1. 规范性参考文献</h2><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[RFC2119]  Bradner, S., <span class="string">"Key words for use in RFCs to Indicate</span></div><div class="line">           Requirement Levels", BCP <span class="number">14</span>, RFC <span class="number">2119</span>, March <span class="number">1997.</span></div><div class="line"></div><div class="line">[RFC5246]  Dierks, T. and E. Rescorla, <span class="string">"The Transport Layer Security</span></div><div class="line">           (TLS) Protocol Version 1.2", RFC <span class="number">5246</span>, August <span class="number">2008.</span></div></pre></td></tr></table></figure>
<h2 id="9-2-参考资料-1"><a href="#9-2-参考资料-1" class="headerlink" title="9.2. 参考资料"></a>9.2. 参考资料</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">[RFC2616]  Fielding, R., Gettys, J., Mogul, J., Frystyk, H.,</div><div class="line">           Masinter, L., Leach, <span class="keyword">P</span>. <span class="built_in">and</span> T. Berners-Lee, <span class="comment">"Hypertext</span></div><div class="line">           Transfer Protocol -- HTTP/<span class="number">1.1</span><span class="comment">", RFC 2616, June 1999.</span></div><div class="line"></div><div class="line">[RFC5077]  Salowey, J., Zhou, H., Eronen, <span class="keyword">P</span>. <span class="built_in">and</span> H. Tschofenig,</div><div class="line">           <span class="comment">"Transport Layer Security (TLS) Session Resumption without</span></div><div class="line">           Server-Side State<span class="comment">", RFC 5077, January 2008.</span></div><div class="line"></div><div class="line">[tor]      Dingledine, R., Matthewson, <span class="keyword">N</span>. <span class="built_in">and</span> <span class="keyword">P</span>. Syverson, <span class="comment">"Tor: The</span></div><div class="line">           Second-Generation Onion Router<span class="comment">", August 2004.</span></div><div class="line"></div><div class="line">[spdy]     Belshe, M. <span class="built_in">and</span> R. Peon, <span class="string">"SPDY Protocol (Internet Draft)"</span>,</div><div class="line">           Feb <span class="number">2012</span>.</div></pre></td></tr></table></figure>
<h1 id="作者地址-1"><a href="#作者地址-1" class="headerlink" title="作者地址"></a>作者地址</h1><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Adam Langley</div><div class="line">Google <span class="keyword">Inc</span></div><div class="line"></div><div class="line"><span class="symbol">Email:</span> agl@google.com</div></pre></td></tr></table></figure>
<p><a href="https://tools.ietf.org/html/draft-agl-tls-nextprotoneg-04" target="_blank" rel="external">原文</a></p>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>坚持原创技术分享，您的支持将鼓励我继续创作！</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wxpay.png" alt="Han Pengfei 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="Han Pengfei 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/网络协议/" rel="tag"># 网络协议</a>
          
            <a href="/tags/HTTP2/" rel="tag"># HTTP2</a>
          
            <a href="/tags/翻译/" rel="tag"># 翻译</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/10/29/hpack-spec/" rel="next" title="HPACK：HTTP/2的首部压缩 (RFC7541)">
                <i class="fa fa-chevron-left"></i> HPACK：HTTP/2的首部压缩 (RFC7541)
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/10/29/Cronet_android设计与实现分析__库的初始化/" rel="prev" title="Cronet android设计与实现分析--库的初始化﻿">
                Cronet android设计与实现分析--库的初始化﻿ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/freesoft.jpg"
                alt="Han Pengfei" />
            
              <p class="site-author-name" itemprop="name">Han Pengfei</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">207</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">19</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">30</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/hanpfei" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://www.douban.com/people/3681478/" target="_blank" title="豆瓣"><i class="fa fa-fw fa-globe"></i>豆瓣</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://www.zhihu.com/people/han-peng-fei-49" target="_blank" title="知乎"><i class="fa fa-fw fa-globe"></i>知乎</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:hanpfei@gmail.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  
                </span>
              
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://developer.android.com/index.html" title="Android Developers" target="_blank">Android Developers</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://source.android.com/" title="Android Open Source Project" target="_blank">Android Open Source Project</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.vants.org/" title="蚂蚁网" target="_blank">蚂蚁网</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#摘要"><span class="nav-number">1.</span> <span class="nav-text">摘要</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Status-of-this-Memo"><span class="nav-number">2.</span> <span class="nav-text">Status of this Memo</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Copyright-Notice"><span class="nav-number">3.</span> <span class="nav-text">Copyright Notice</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#目录"><span class="nav-number">4.</span> <span class="nav-text">目录</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-简介"><span class="nav-number">4.1.</span> <span class="nav-text">1. 简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-要求表示法"><span class="nav-number">4.2.</span> <span class="nav-text">2. 要求表示法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-下一个协议协商-扩展"><span class="nav-number">4.3.</span> <span class="nav-text">3. 下一个协议协商 扩展</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-协议选择"><span class="nav-number">4.4.</span> <span class="nav-text">4. 协议选择</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-设计讨论"><span class="nav-number">4.5.</span> <span class="nav-text">5. 设计讨论</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-安全性注意事项"><span class="nav-number">4.6.</span> <span class="nav-text">6. 安全性注意事项</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-IANA注意事项"><span class="nav-number">4.7.</span> <span class="nav-text">7. IANA注意事项</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-致谢"><span class="nav-number">4.8.</span> <span class="nav-text">8. 致谢</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-参考文献"><span class="nav-number">4.9.</span> <span class="nav-text">9. 参考文献</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#9-1-规范性参考文献"><span class="nav-number">4.9.1.</span> <span class="nav-text">9.1. 规范性参考文献</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-2-参考资料"><span class="nav-number">4.9.2.</span> <span class="nav-text">9.2. 参考资料</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#作者地址"><span class="nav-number">4.10.</span> <span class="nav-text">作者地址</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#1-简介-1"><span class="nav-number">5.</span> <span class="nav-text">1. 简介</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-要求表示法-1"><span class="nav-number">6.</span> <span class="nav-text">2.  要求表示法</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-下一个协议协商扩展"><span class="nav-number">7.</span> <span class="nav-text">3. 下一个协议协商扩展</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-协议选择-1"><span class="nav-number">8.</span> <span class="nav-text">4. 协议选择</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-设计讨论-1"><span class="nav-number">9.</span> <span class="nav-text">5. 设计讨论</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-安全性注意事项-1"><span class="nav-number">10.</span> <span class="nav-text">6. 安全性注意事项</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7-IANA注意事项-1"><span class="nav-number">11.</span> <span class="nav-text">7. IANA注意事项</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#8-鸣谢"><span class="nav-number">12.</span> <span class="nav-text">8. 鸣谢</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#9-参考文献-1"><span class="nav-number">13.</span> <span class="nav-text">9. 参考文献</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#9-1-规范性参考文献-1"><span class="nav-number">13.1.</span> <span class="nav-text">9.1. 规范性参考文献</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-2-参考资料-1"><span class="nav-number">13.2.</span> <span class="nav-text">9.2. 参考资料</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#作者地址-1"><span class="nav-number">14.</span> <span class="nav-text">作者地址</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2016.09.16 &mdash; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Han Pengfei</span>

  

  
</div>




  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Mist</a> v6.0.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.0.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.0.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.3"></script>



  



	





  





  









<script src="//cdn1.lncld.net/static/js/3.11.1/av-min.js"></script>



<script src="//unpkg.com/valine/dist/Valine.min.js"></script>

<script>
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#comments',
    verify: false,
    notify: false,
    appId: 's9sbM9ODdusCzKcm5JcIj6t8-gzGzoHsz',
    appKey: 'UoO9ia1DLNwOXRUsTBQ6QXxm',
    placeholder: 'ヾﾉ≧∀≦)o来啊，快活啊!',
    avatar: 'mm',
    meta: guest,
    pageSize: '10' || 10,
    visitor: true,
    lang: '' || 'zh-cn'
  });
</script>


  





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  
  

  

  

  

  

</body>
</html>
