<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Chromium GN构建工具的使用 | WolfcsTech</title><link rel="stylesheet" type="text/css" href="//fonts.css.network/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.2.0"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=1.2.0"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Chromium GN构建工具的使用</h1><a id="logo" href="/.">WolfcsTech</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">Chromium GN构建工具的使用</h1><div class="post-meta">Nov 16, 2016<span> | </span><span class="category"><a href="/categories/Android开发/">Android开发</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-disqus-identifier="2016/11/16/ChromiumGN构建工具的使用/" href="/2016/11/16/ChromiumGN构建工具的使用/#disqus_thread" class="disqus-comment-count"></a><div class="post-content"><p>Chromium整体的构建过程大体如下：</p>
<p><img src="https://www.wolfcstech.com/images/1315506-eba64e268085674c.png" alt="Chromium build flow"><br><a id="more"></a><br>这个过程大体为，先由gn工具根据各个模块的.gn配置文件，或gyp工具根据各个模块的.gyp配置文件，产生.ninja文件，再由ninja工具产生最终的目标文件，比如静态库、动态库、exe可执行文件或者是apk文件等等。gyp工具是用Python写的，gn是用C写的，gn增量构建最快。整个Chromium项目，在构建系统方面，也是逐渐在全部转向gn构建。</p>
<p>gn工具不仅仅在我们构建chromium时可以用来产生.ninja文件，它还可以帮助我们描绘chromium的项目地图，比如获取某个模块依赖的所有其它模块，依赖某个模块的所有其它模块、构建参数等信息，可以帮助我们对构建配置的有效性进行检查等。在基于chromium模块进行开发时，gn工具可以为我们提供巨大的帮助。</p>
<p>这里我们来看一下gn工具的用法，逐个来看gn提供的每个命令。</p>
<h2 id="gn-args"><a href="#gn-args" class="headerlink" title="gn args"></a>gn args</h2><p>这个命令有两个作用，一是生成.ninja构建配置文件，二是查看当前构建环境的配置参数。</p>
<h3 id="生成-ninja"><a href="#生成-ninja" class="headerlink" title="生成.ninja"></a>生成.ninja</h3><p>生成.ninja是gn工具的基本功能。如在 <a href="https://www.wolfcstech.com/2016/10/16/Chromium_Android%E7%BC%96%E8%AF%91%E6%8C%87%E5%8D%97/">Chromium Android编译指南</a> 中所示，要构建chromium，或其中的模块，需要先生成.ninja文件对整个构建环境进行配置。为Android版chromium做构建配置时，所执行的命令为：<br><figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">buildtools/linux64/gn args <span class="keyword">out</span>/<span class="keyword">Default</span></div></pre></td></tr></table></figure></p>
<p>这个命令的参数是输出目录的路径。这个命令启动系统的默认编辑器，创建<code>out/Default/args.gn</code>文件，我们在编辑器中加入我们自己的配置项，如：<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="attr">target_os</span> = <span class="string">"android"</span></div><div class="line"><span class="attr">target_cpu</span> = <span class="string">"arm"</span>  # (default)</div><div class="line"><span class="attr">is_debug</span> = <span class="literal">false</span>  # (default)</div><div class="line"></div><div class="line"><span class="comment"># Other args you may want to set:</span></div><div class="line"><span class="attr">is_component_build</span> = <span class="literal">false</span></div><div class="line"><span class="attr">is_clang</span> = <span class="literal">false</span></div><div class="line"><span class="attr">symbol_level</span> = <span class="number">1</span>  # Faster build with fewer symbols. -g1 rather than -g2</div><div class="line"><span class="attr">enable_incremental_javac</span> = <span class="literal">false</span>  # Much faster; experimental</div><div class="line"><span class="attr">android_ndk_root</span> = <span class="string">"~/dev_tools/Android/android-ndk-r10e"</span></div><div class="line"><span class="attr">android_sdk_root</span> = <span class="string">"~/dev_tools/Android/sdk"</span></div><div class="line"><span class="attr">android_sdk_build_tools_version</span> = <span class="string">"23.0.2"</span></div><div class="line"></div><div class="line"><span class="attr">disable_file_support</span> = <span class="literal">true</span></div><div class="line"><span class="attr">disable_ftp_support</span> = <span class="literal">true</span></div><div class="line"><span class="attr">enable_websockets</span> = <span class="literal">false</span></div></pre></td></tr></table></figure></p>
<p>gn根据创建的<code>out/Default/args.gn</code>文件，及系统中其它的配置，产生ninja文件。</p>
<h3 id="查看当前构建环境的配置参数"><a href="#查看当前构建环境的配置参数" class="headerlink" title="查看当前构建环境的配置参数"></a>查看当前构建环境的配置参数</h3><p>gn args命令还可以查看当前构建环境的可以配置的参数，参数的默认值及默认值的配置文件等。chromium用到了许多的配置参数。对于这些配置参数中的大多数，即使用户不指定，chromium的构建系统也会提供默认值。当我们在为不知道可以对构建做些什么样的配置，各个配置项的含义，或者配置项默认值的设置位置而抓狂时，这个命令会显得非常有价值。</p>
<p>对于Chromium的Android构建环境，能配置的参数及其相关信息大体如下：<br><figure class="highlight sqf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">$ buildtools/linux64/gn args --<span class="built_in">list</span> out/<span class="keyword">Default</span>/</div><div class="line">......</div><div class="line">android_ndk_root  <span class="keyword">Default</span> = <span class="string">"//third_party/android_tools/ndk"</span></div><div class="line">    <span class="comment">//build/config/android/config.gni:66</span></div><div class="line"></div><div class="line">android_ndk_version  <span class="keyword">Default</span> = <span class="string">"r10e"</span></div><div class="line">    <span class="comment">//build/config/android/config.gni:67</span></div><div class="line"></div><div class="line">android_sdk_build_tools_version  <span class="keyword">Default</span> = <span class="string">"23.0.1"</span></div><div class="line">    <span class="comment">//build/config/android/config.gni:71</span></div><div class="line"></div><div class="line">android_sdk_root  <span class="keyword">Default</span> = <span class="string">"//third_party/android_tools/sdk"</span></div><div class="line">    <span class="comment">//build/config/android/config.gni:69</span></div><div class="line">......</div><div class="line">use_platform_icu_alternatives  <span class="keyword">Default</span> = <span class="literal">true</span></div><div class="line">    <span class="comment">//url/features.gni:10</span></div><div class="line">    Enables the use of ICU alternatives <span class="built_in">in</span> lieu of ICU. The <span class="built_in">flag</span> is used</div><div class="line">    <span class="keyword">for</span> Cronet <span class="keyword">to</span> reduce the <span class="built_in">size</span> of the Cronet binary.</div><div class="line">......</div></pre></td></tr></table></figure></p>
<p>这个功能的gn args命令参数为<code>--list [output_dir]</code>。可见gn向我们展示了能为构建定制的每个参数，参数的默认值，及设置参数默认值的文件的位置。<br>这个工具展示了每一个标记配置项的名称，默认值，创建该标记配置项的配置文件，以及标记配置项作用的说明。</p>
<h2 id="gn-gen"><a href="#gn-gen" class="headerlink" title="gn gen"></a>gn gen</h2><p>这个命令也是用于产生.ninja文件的，其参数如下：<br><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">usage:  gn gen <span class="meta">[&lt;ide options&gt;]</span> &lt;out_dir&gt;</div></pre></td></tr></table></figure></p>
<p>这个命令根据当前的代码树及配置，产生ninja文件，并把它们放在给定的目录下。输出目录可以是源码库的绝对地址，比如<code>//out/foo</code>，也可以是相对于当前目录的地址，如：<code>out/foo</code>。上面的<code>gn args out/Default</code>实际上等价于，启动编辑器编辑参数创建<code>out/Default/args.gn</code>文件之后，执行<code>gn gen &lt;out_dir&gt;</code>。</p>
<p>实际在构建chromium及其子模块时，这个命令会更加常用。对于特定的平台，通常我们在完成构建环境的配置之后，就不会经常有修改构建配置参数文件的需要了。</p>
<h2 id="gn-clean"><a href="#gn-clean" class="headerlink" title="gn clean"></a>gn clean</h2><p>这个命令用于对历史构建进行清理。<br><figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">usage:</span>  gn clean <span class="params">&lt;out_dir&gt;</span></div></pre></td></tr></table></figure></p>
<p>它会删除输出目录下除<code>args.gn</code>文件外的所有内容，并创建一个可以重新产生构建配置的ninja构建环境。这个命令也比较常用，用来消除历史构建的影响。</p>
<h2 id="gn-desc"><a href="#gn-desc" class="headerlink" title="gn desc"></a>gn desc</h2><p>这个命令用于显示关于一个给定target或config的信息。<br><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">usage:  gn desc &lt;out_dir&gt; &lt;label <span class="keyword">or</span> pattern&gt; <span class="meta">[&lt;what to show&gt;]</span> [--blame] [--format=json]</div></pre></td></tr></table></figure></p>
<p>构建参数等相关信息，取自给出的<code>&lt;out_dir&gt;</code>。<code>&lt;label or pattern&gt;</code>可以是一个target标签，一个config标签，或一个标签模式 (参考”gn help label_pattern”)。标签模式只匹配targets。</p>
<p>比如我们要查看chromium的net模块相关的信息：<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div></pre></td><td class="code"><pre><div class="line">$ gn desc out/Default net</div><div class="line">Target <span class="comment">//net:net</span></div><div class="line"><span class="string">Type:</span> source_set</div><div class="line"><span class="string">Toolchain:</span> <span class="comment">//build/toolchain/android:arm</span></div><div class="line"></div><div class="line">visibility</div><div class="line">  *</div><div class="line"></div><div class="line">testonly</div><div class="line">  <span class="literal">false</span></div><div class="line"></div><div class="line">check_includes</div><div class="line">  <span class="literal">true</span></div><div class="line"></div><div class="line">allow_circular_includes_from</div><div class="line"></div><div class="line">sources</div><div class="line">......</div><div class="line">  <span class="comment">//net/spdy/spdy_buffer.cc</span></div><div class="line">  <span class="comment">//net/spdy/spdy_buffer.h</span></div><div class="line">  <span class="comment">//net/spdy/spdy_buffer_producer.cc</span></div><div class="line">  <span class="comment">//net/spdy/spdy_buffer_producer.h</span></div><div class="line">......</div><div class="line"></div><div class="line"><span class="keyword">public</span></div><div class="line">  [All headers listed <span class="keyword">in</span> the sources are <span class="keyword">public</span>.]</div><div class="line"></div><div class="line">configs (<span class="keyword">in</span> order applying, <span class="keyword">try</span> also --tree)</div><div class="line">......</div><div class="line">  <span class="comment">//third_party/boringssl:external_config</span></div><div class="line">  <span class="comment">//net:net_resources_grit_config</span></div><div class="line">  <span class="comment">//base:android_system_libs</span></div><div class="line">  <span class="comment">//sdch:sdch_config</span></div><div class="line">  <span class="comment">//third_party/zlib:zlib_config</span></div><div class="line">  <span class="comment">//net:jni_includes_net_jni_headers</span></div><div class="line"></div><div class="line">public_configs (<span class="keyword">in</span> order applying, <span class="keyword">try</span> also --tree)</div><div class="line">  <span class="comment">//net:net_config</span></div><div class="line">  <span class="comment">//third_party/protobuf:using_proto</span></div><div class="line">  <span class="comment">//third_party/protobuf:protobuf_config</span></div><div class="line">  <span class="comment">//build/config/compiler:no_size_t_to_int_warning</span></div><div class="line">  <span class="comment">//third_party/boringssl:external_config</span></div><div class="line"></div><div class="line">all_dependent_configs (<span class="keyword">in</span> order applying, <span class="keyword">try</span> also --tree)</div><div class="line">  <span class="comment">//base/allocator:wrap_malloc_symbols</span></div><div class="line"></div><div class="line">asmflags</div><div class="line">  -fno-strict-aliasing</div><div class="line">  --param=ssp-buffer-size=<span class="number">4</span></div><div class="line">  -fstack-protector</div><div class="line">  -funwind-tables</div><div class="line">  -fPIC</div><div class="line">......</div><div class="line"></div><div class="line">cflags</div><div class="line">  -fno-strict-aliasing</div><div class="line">  --param=ssp-buffer-size=<span class="number">4</span></div><div class="line">  -fstack-protector</div><div class="line">  -funwind-tables</div><div class="line">  -fPIC</div><div class="line">......</div><div class="line"></div><div class="line">cflags_cc</div><div class="line">  -fno-threadsafe-statics</div><div class="line">  -fvisibility-inlines-hidden</div><div class="line">  -std=gnu++<span class="number">11</span></div><div class="line">  -Wno-narrowing</div><div class="line">  -fno-rtti</div><div class="line">  -isystem..<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span><span class="regexp">~/dev_tools/</span>Android<span class="regexp">/android-ndk-r10e/</span>sources<span class="regexp">/cxx-stl/</span>llvm-libc++<span class="regexp">/libcxx/</span>include</div><div class="line">  -isystem..<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span><span class="regexp">~/dev_tools/</span>Android<span class="regexp">/android-ndk-r10e/</span>sources<span class="regexp">/cxx-stl/</span>llvm-libc++abi<span class="regexp">/libcxxabi/</span>include</div><div class="line">  -isystem..<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span><span class="regexp">~/dev_tools/</span>Android<span class="regexp">/android-ndk-r10e/</span>sources<span class="regexp">/android/</span>support/include</div><div class="line">  -fno-exceptions</div><div class="line"></div><div class="line">cflags_objcc</div><div class="line">  -fno-threadsafe-statics</div><div class="line">  -fvisibility-inlines-hidden</div><div class="line">  -std=gnu++<span class="number">11</span></div><div class="line">  -fno-rtti</div><div class="line">  -fno-exceptions</div><div class="line"></div><div class="line">defines</div><div class="line">......</div><div class="line">  DISABLE_FTP_SUPPORT=<span class="number">1</span></div><div class="line">  GOOGLE_PROTOBUF_NO_RTTI</div><div class="line">  GOOGLE_PROTOBUF_NO_STATIC_INITIALIZER</div><div class="line">  HAVE_PTHREAD</div><div class="line"></div><div class="line">include_dirs</div><div class="line">  <span class="comment">//</span></div><div class="line">  <span class="comment">//out/Default/gen/</span></div><div class="line">  <span class="regexp">/usr/</span>include<span class="regexp">/kerberosV/</span></div><div class="line">  <span class="comment">//third_party/protobuf/src/</span></div><div class="line">  <span class="comment">//out/Default/gen/protoc_out/</span></div><div class="line">  <span class="comment">//third_party/protobuf/src/</span></div><div class="line">......</div><div class="line"></div><div class="line">ldflags</div><div class="line">  -Wl,--fatal-warnings</div><div class="line">  -fPIC</div><div class="line">......</div><div class="line"></div><div class="line">Direct dependencies (<span class="keyword">try</span> also <span class="string">"--all"</span>, <span class="string">"--tree"</span>, or even <span class="string">"--all --tree"</span>)</div><div class="line">  <span class="comment">//base:base</span></div><div class="line">......</div><div class="line"></div><div class="line">libs</div><div class="line">  c++_static</div><div class="line">  <span class="regexp">/home/</span><span class="regexp">~/dev_tools/</span>Android<span class="regexp">/android-ndk-r10e/</span>toolchains<span class="regexp">/arm-linux-androideabi-4.9/</span>prebuilt<span class="regexp">/linux-x86_64/</span>lib<span class="regexp">/gcc/</span>arm-linux-androideabi<span class="regexp">/4.9/</span>libgcc.a</div><div class="line">  c</div><div class="line">  atomic</div><div class="line">  log</div><div class="line"></div><div class="line">lib_dirs</div><div class="line"> <span class="regexp">~/dev_tools/</span>Android<span class="regexp">/android-ndk-r10e/</span>sources<span class="regexp">/cxx-stl/</span>llvm-libc++<span class="regexp">/libs/</span>armeabi-v7a/</div></pre></td></tr></table></figure></p>
<p>可以看到gn desc命令向我们展示了，编译net模块时，包含的所有源文件，该模块发布的头文件，依赖的库，依赖的头文件路径，依赖的库文件的路径，依赖的其它模块，编译参数，链接参数，预定义宏等等等，应有尽有。在我们不喜欢chromium的构建系统及其项目的文件组织结构，而想要将某个模块转换为其它的文件组织结构，比如Eclipse或其它IDE常见的项目文件组织方式时，或者要将编译出来的动态链接库so文件用在其它项目里，被预定义宏的差异搞得焦头烂额时，这个命令就能派上用场了。</p>
<p>借助于这个工具，我们可以很方便的开发自动化的工具，来将chromium的模块单独抽出来用在其它地方，比如我们可以提取net模块发布的头文件，将net模块用在android中。我们之前就有做过这样一个小工具：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">import</span> shutil</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_usage_and_exit</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">print</span> sys.argv[<span class="number">0</span>] + <span class="string">" [chromium_src_root]"</span> + <span class="string">"[out_dir]"</span> + <span class="string">" [target_name]"</span> + <span class="string">" [targetroot]"</span></div><div class="line">    exit(<span class="number">1</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">copy_file</span><span class="params">(src_file_path, target_file_path)</span>:</span></div><div class="line">    <span class="keyword">if</span> os.path.exists(target_file_path):</div><div class="line">        <span class="keyword">return</span></div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(src_file_path):</div><div class="line">        <span class="keyword">return</span></div><div class="line">    target_dir_path = os.path.dirname(target_file_path)</div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(target_dir_path):</div><div class="line">        os.makedirs(target_dir_path)</div><div class="line"></div><div class="line">    shutil.copy(src_file_path, target_dir_path)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">copy_all_files</span><span class="params">(source_dir, all_files, target_dir)</span>:</span></div><div class="line">    <span class="keyword">for</span> one_file <span class="keyword">in</span> all_files:</div><div class="line">        source_path = source_dir + os.path.sep + one_file</div><div class="line">        target_path = target_dir + os.path.sep + one_file</div><div class="line">        copy_file(source_path, target_path)</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    <span class="keyword">if</span> len(sys.argv) &lt; <span class="number">4</span> <span class="keyword">or</span> len(sys.argv) &gt; <span class="number">5</span>:</div><div class="line">        print_usage_and_exit()</div><div class="line">    chromium_src_root = sys.argv[<span class="number">1</span>]</div><div class="line">    out_dir = sys.argv[<span class="number">2</span>]</div><div class="line">    target_name = sys.argv[<span class="number">3</span>]</div><div class="line">    target_root_path = <span class="string">"."</span></div><div class="line">    <span class="keyword">if</span> len(sys.argv) == <span class="number">5</span>:</div><div class="line">        target_root_path = sys.argv[<span class="number">4</span>]</div><div class="line">    target_root_path = os.path.abspath(target_root_path)</div><div class="line"></div><div class="line">    os.chdir(chromium_src_root)</div><div class="line"></div><div class="line">    cmd = <span class="string">"gn desc "</span> + out_dir + <span class="string">" "</span> + target_name</div><div class="line">    outputs = os.popen(cmd).readlines()</div><div class="line">    source_start = <span class="keyword">False</span></div><div class="line">    all_headers = []</div><div class="line"></div><div class="line">    public_start = <span class="keyword">False</span></div><div class="line">    public_headers = []</div><div class="line"></div><div class="line">    <span class="keyword">for</span> output_line <span class="keyword">in</span> outputs:</div><div class="line">        output_line = output_line.strip()</div><div class="line">        <span class="keyword">if</span> output_line.startswith(<span class="string">"sources"</span>):</div><div class="line">            source_start = <span class="keyword">True</span></div><div class="line">            <span class="keyword">continue</span></div><div class="line">        <span class="keyword">elif</span> source_start <span class="keyword">and</span> len(output_line) == <span class="number">0</span>:</div><div class="line">            source_start = <span class="keyword">False</span></div><div class="line">            <span class="keyword">continue</span></div><div class="line">        <span class="keyword">elif</span> source_start <span class="keyword">and</span> output_line.endswith(<span class="string">".h"</span>):</div><div class="line">            output_line = output_line[<span class="number">1</span>:]</div><div class="line">            all_headers.append(output_line)</div><div class="line">        <span class="keyword">elif</span> output_line == <span class="string">"public"</span>:</div><div class="line">            public_start = <span class="keyword">True</span></div><div class="line">            <span class="keyword">continue</span></div><div class="line">        <span class="keyword">elif</span> public_start <span class="keyword">and</span> len(output_line) == <span class="number">0</span>:</div><div class="line">            public_start = <span class="keyword">False</span></div><div class="line">            <span class="keyword">continue</span></div><div class="line">        <span class="keyword">elif</span> public_start:</div><div class="line">            public_headers.append(output_line)</div><div class="line"></div><div class="line">    <span class="keyword">if</span> len(public_headers) == <span class="number">1</span>:</div><div class="line">        public_headers = all_headers</div><div class="line">    <span class="keyword">if</span> len(public_headers) &gt; <span class="number">1</span>:</div><div class="line">        copy_all_files(chromium_src_root, public_headers, target_dir=target_root_path)</div></pre></td></tr></table></figure></p>
<p>这个命令还可以帮我们dump出模块的整个依赖树，如net模块的依赖树：<br><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">$ gn <span class="keyword">desc</span> <span class="keyword">out</span>/<span class="keyword">Default</span> <span class="comment">//net deps --tree</span></div><div class="line"><span class="comment">//base:base</span></div><div class="line">  <span class="comment">//base:base_jni_headers</span></div><div class="line">    <span class="comment">//base:android_runtime_jni_headers</span></div><div class="line">      <span class="comment">//base:android_runtime_jni_headers__jni_Runtime</span></div><div class="line">    <span class="comment">//base:base_jni_headers__jni_gen</span></div><div class="line">  <span class="comment">//base:base_paths</span></div><div class="line">  <span class="comment">//base:base_static</span></div><div class="line">  <span class="comment">//base:build_date</span></div><div class="line">......</div><div class="line"><span class="comment">//url:url_features</span></div></pre></td></tr></table></figure></p>
<p>这个命令可以为我们展示不同类型信息的每一项具体来自于哪个文件。如net模块的C编译标记选项(cflags)的信息如下：<br><figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$ gn desc out/Default //net cflags --blame</div><div class="line">From //build/config/compiler:compiler</div><div class="line">     (Added by //build/config/BUILDCONFIG.gn:461)</div><div class="line">  -<span class="ruby">fno-strict-aliasing</span></div><div class="line">  -<span class="ruby">-param=ssp-buffer-size=<span class="number">4</span></span></div><div class="line">  -<span class="ruby">fstack-protector</span></div><div class="line">  -<span class="ruby">funwind-tables</span></div><div class="line">  -<span class="ruby">fPIC</span></div><div class="line">......</div></pre></td></tr></table></figure></p>
<h2 id="gn-ls"><a href="#gn-ls" class="headerlink" title="gn ls"></a>gn ls</h2><p>这个命令展示给定构建目录下，匹配某个模式的所有targets。<br><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">usage: gn ls &lt;out_dir&gt; <span class="meta">[&lt;label_pattern&gt;]</span> [--all-toolchains] [--<span class="keyword">as</span>=...] [--<span class="class"><span class="keyword">type</span></span>=...] [--testonly=...]</div></pre></td></tr></table></figure></p>
<p>默认情况下，除非明确地提供了工具链参数，只有默认工具链中的target会被匹配。如果没有指定标签参数，则显示所有的targets。标签模式不是常规的正则表达式 (可以参考”gn help label_pattern”)。如net下的targets：<br><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">$ gn ls out/Default //net/*</div><div class="line"><span class="code">......</span></div><div class="line">//net:http_server</div><div class="line">//net:net</div><div class="line">......</div><div class="line"><span class="comment">//net:net_quic_proto</span></div><div class="line"><span class="code">......</span></div><div class="line">//net:quic_client</div><div class="line">//net:quic_packet_printer</div><div class="line">//net:quic_server</div><div class="line">......</div></pre></td></tr></table></figure></p>
<p>其它一些关于gn ls命令的例子：<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">gn <span class="keyword">ls</span> <span class="keyword">out</span>/Debug</div><div class="line">    这个命令会列出所有的targets。</div><div class="line"></div><div class="line">gn <span class="keyword">ls</span> <span class="keyword">out</span>/Debug <span class="string">"//base/*"</span></div><div class="line">    Lists all targets <span class="keyword">in</span> the directory base and all subdirectories.</div><div class="line"></div><div class="line">gn <span class="keyword">ls</span> <span class="keyword">out</span>/Debug <span class="string">"//base:*"</span></div><div class="line">    Lists all targets defined <span class="keyword">in</span> <span class="comment">//base/BUILD.gn.</span></div><div class="line"></div><div class="line">gn <span class="keyword">ls</span> <span class="keyword">out</span>/Debug <span class="comment">//base --as=output</span></div><div class="line">    Lists the build output <span class="keyword">file</span> <span class="keyword">for</span> <span class="comment">//base:base</span></div><div class="line"></div><div class="line">gn <span class="keyword">ls</span> <span class="keyword">out</span>/Debug --<span class="keyword">type</span>=executable</div><div class="line">    Lists all executables produced <span class="keyword">by</span> the build.</div><div class="line"></div><div class="line">gn <span class="keyword">ls</span> <span class="keyword">out</span>/Debug <span class="string">"//base/*"</span> --<span class="keyword">as</span>=output | xargs ninja -C <span class="keyword">out</span>/Debug</div><div class="line">    Builds all targets <span class="keyword">in</span> <span class="comment">//base and all subdirectories.</span></div><div class="line"></div><div class="line">gn <span class="keyword">ls</span> <span class="keyword">out</span>/Debug <span class="comment">//base --all-toolchains</span></div><div class="line">    Lists all variants of the target <span class="comment">//base:base (it may be referenced in multiple toolchains).</span></div></pre></td></tr></table></figure></p>
<h2 id="gn-path"><a href="#gn-path" class="headerlink" title="gn path"></a>gn path</h2><p>这命令查找两个taregets之间的依赖路径。<br><figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">usage:</span> gn path <span class="params">&lt;out_dir&gt;</span> <span class="params">&lt;target_one&gt;</span> <span class="params">&lt;target_two&gt;</span></div></pre></td></tr></table></figure></p>
<p>每个依赖路径输出为一个组，组与组之间用新行分割。参数中两个targets的顺序不限。默认情况下，只打印一个路径。如果某个路径只包含公共依赖，则会输出最短的公共路径。否则，输出最短的公共或私有路径。如果指定了–with-data，则数据依赖也会考虑。如果有多个最短路径，则会从中选出一个。加上–all则会输出两个targets之间的所有依赖路径。</p>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ gn path <span class="keyword">out</span>/<span class="keyword">Default</span> <span class="comment">//base //net --all</span></div><div class="line"><span class="comment">//net:net --[private]--&gt;</span></div><div class="line"><span class="comment">//base:base</span></div><div class="line">......</div></pre></td></tr></table></figure>
<h2 id="gn-refs"><a href="#gn-refs" class="headerlink" title="gn refs"></a>gn refs</h2><p>这个命令可以用来查找反向的依赖(也就是引用了某些东西的targets)。<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gn refs <span class="symbol">&lt;out_dir&gt;</span> (<span class="symbol">&lt;label_pattern&gt;</span>|<span class="symbol">&lt;label&gt;</span>|<span class="symbol">&lt;file&gt;</span>|@<span class="symbol">&lt;response_file&gt;</span>)* [--<span class="keyword">all</span>] [--<span class="keyword">all</span>-toolchains] [--<span class="keyword">as</span>=...] [--testonly=...] [--<span class="built_in">type</span>=...]</div></pre></td></tr></table></figure></p>
<p>输入可以是如下这些：</p>
<ul>
<li>Target标签</li>
<li>Config标签</li>
<li>标签模式</li>
<li>文件名</li>
<li>响应文件</li>
</ul>
<p>这个命令输出依赖于参数中的输入得targets，比如：<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">$ gn refs out<span class="regexp">/Default/</span> net</div><div class="line"><span class="regexp">//</span>:both_gn_and_gyp</div><div class="line"><span class="regexp">//</span>components<span class="regexp">/cronet/</span>android:cronet</div><div class="line"><span class="regexp">//</span>components<span class="regexp">/cronet/</span>android:cronet_static</div><div class="line"><span class="regexp">//</span>net:balsa</div><div class="line"><span class="regexp">//</span>net:crypto_message_printer</div><div class="line"><span class="regexp">//</span>net:disk_cache_memory_test</div><div class="line"><span class="regexp">//</span>net:http_server</div><div class="line"><span class="regexp">//</span>net:quic_client</div><div class="line"><span class="regexp">//</span>net:quic_packet_printer</div><div class="line"><span class="regexp">//</span>net:quic_server</div><div class="line"><span class="regexp">//</span>net:simple_quic_tools</div><div class="line"><span class="regexp">//</span>net:stale_while_revalidate_experiment_domains</div></pre></td></tr></table></figure></p>
<p>其它一些关于gn refs命令的例子：<br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">gn refs out/Debug<span class="comment"> //tools/gn:gn</span></div><div class="line">    Find all targets depending <span class="keyword">on</span> <span class="title">the</span> <span class="title">given</span> <span class="title">exact</span> <span class="title">target</span> <span class="title">name</span>.</div><div class="line"></div><div class="line">gn refs out/Debug<span class="comment"> //base:i18n --as=buildfiles | xargs gvim</span></div><div class="line">    Edit all .gn <span class="built_in">files</span> containing references <span class="built_in">to</span><span class="comment"> //base:i18n</span></div><div class="line"></div><div class="line">gn refs out/Debug<span class="comment"> //base --all</span></div><div class="line">    List all targets depending directly <span class="keyword">or</span> indirectly <span class="keyword">on</span> //<span class="title">base</span>:<span class="title">base</span>.</div><div class="line"></div><div class="line">gn refs out/Debug <span class="string">"//base/*"</span></div><div class="line">    List all targets depending directly <span class="keyword">on</span> <span class="title">any</span> <span class="title">target</span> <span class="title">in</span> //<span class="title">base</span> <span class="title">or</span> <span class="title">its</span> <span class="title">subdirectories</span>.</div><div class="line"></div><div class="line">gn refs out/Debug <span class="string">"//base:*"</span></div><div class="line">    List all targets depending directly <span class="keyword">on</span> <span class="title">any</span> <span class="title">target</span> <span class="title">in</span> //<span class="title">base</span>/<span class="title">BUILD</span>.<span class="title">gn</span>.</div><div class="line"></div><div class="line">gn refs out/Debug<span class="comment"> //base --tree</span></div><div class="line">    Print <span class="keyword">a</span> reverse dependency tree <span class="keyword">of</span><span class="comment"> //base:base</span></div><div class="line"></div><div class="line">gn refs out/Debug<span class="comment"> //base/macros.h</span></div><div class="line">    Print target(s) listing<span class="comment"> //base/macros.h as a source.</span></div><div class="line"></div><div class="line">gn refs out/Debug<span class="comment"> //base/macros.h --tree</span></div><div class="line">    Display <span class="keyword">a</span> reverse dependency tree <span class="built_in">to</span> <span class="built_in">get</span> <span class="built_in">to</span> <span class="keyword">the</span> given <span class="built_in">file</span>. This will show how dependencies will reference that <span class="built_in">file</span>.</div><div class="line"></div><div class="line">gn refs out/Debug<span class="comment"> //base/macros.h //base/at_exit.h --all</span></div><div class="line">    Display all unique targets <span class="keyword">with</span> some dependency path <span class="built_in">to</span> <span class="keyword">a</span> target containing either <span class="keyword">of</span> <span class="keyword">the</span> given <span class="built_in">files</span> <span class="keyword">as</span> <span class="keyword">a</span> source.</div><div class="line"></div><div class="line">gn refs out/Debug<span class="comment"> //base/macros.h --testonly=true --type=executable --all --as=output</span></div><div class="line">    Display <span class="keyword">the</span> executable <span class="built_in">file</span> names <span class="keyword">of</span> all test executables potentially affected <span class="keyword">by</span> <span class="keyword">a</span> change <span class="built_in">to</span> <span class="keyword">the</span> given <span class="built_in">file</span>.</div></pre></td></tr></table></figure></p>
<h2 id="gn-check"><a href="#gn-check" class="headerlink" title="gn check"></a>gn check</h2><p>这个命令可以用来检查头文件依赖的有效性。其参数为：<br><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gn check &lt;out_dir&gt; <span class="meta">[&lt;label_pattern&gt;]</span> [--force]</div></pre></td></tr></table></figure></p>
<p>如：<br><figure class="highlight smali"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ gn<span class="built_in"> check </span>out/Default/ net</div><div class="line">Header dependency<span class="built_in"> check </span>OK</div></pre></td></tr></table></figure></p>
<h2 id="gn-help"><a href="#gn-help" class="headerlink" title="gn help"></a>gn help</h2><p>这个命令会向我们展示gn工具的帮助信息，可以用来获取关于上面所有的gn命令，及内置得targets，内建预定义变量的所有相关信息。如：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">$ gn <span class="keyword">help</span></div><div class="line">Commands (<span class="keyword">type</span> <span class="string">"gn help &lt;command&gt;"</span> <span class="keyword">for</span> more details):</div><div class="line">  args: Display <span class="keyword">or</span> configure arguments declared <span class="keyword">by</span> the build.</div><div class="line">  <span class="keyword">check</span>: <span class="keyword">Check</span> header dependencies.</div><div class="line">  clean: Cleans the <span class="keyword">output</span> directory.</div><div class="line">  <span class="keyword">desc</span>: <span class="keyword">Show</span> lots <span class="keyword">of</span> insightful information about a target <span class="keyword">or</span> config.</div><div class="line">  <span class="keyword">format</span>: <span class="keyword">Format</span> .gn file.</div><div class="line">  gen: Generate ninja files.</div><div class="line">  <span class="keyword">help</span>: Does what you think.</div><div class="line">  ls: <span class="keyword">List</span> matching targets.</div><div class="line">  <span class="keyword">path</span>: Find paths <span class="keyword">between</span> two targets.</div><div class="line">  refs: Find <span class="keyword">stuff</span> <span class="keyword">referencing</span> a target <span class="keyword">or</span> file.</div><div class="line"></div><div class="line">Target declarations (<span class="keyword">type</span> <span class="string">"gn help &lt;function&gt;"</span> <span class="keyword">for</span> more details):</div><div class="line">  <span class="keyword">action</span>: <span class="keyword">Declare</span> a target that runs a script a single time.</div><div class="line">  action_foreach: <span class="keyword">Declare</span> a target that runs a script <span class="keyword">over</span> a <span class="keyword">set</span> <span class="keyword">of</span> files.</div><div class="line">  bundle_data: [iOS/OS X] <span class="keyword">Declare</span> a target <span class="keyword">without</span> output.</div><div class="line">  copy: <span class="keyword">Declare</span> a target that copies files.</div><div class="line">  create_bundle: [iOS/OS X] <span class="keyword">Build</span> an OS X / iOS bundle.</div><div class="line">......</div></pre></td></tr></table></figure></p>
</div><div class="tags"><a href="/tags/Android开发/">Android开发</a><a href="/tags/chromium/">chromium</a></div><div class="post-nav"><a href="/2016/11/18/asymmetric_encryption_and_certificate/" class="pre">非对称加密与证书</a><a href="/2016/11/15/OkHttp3-HTTP请求执行流程分析/" class="next">OkHttp3 HTTP请求执行流程分析</a></div><div id="disqus_thread"></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="widget"><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="请输入关键字..."/></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android开发/">Android开发</a><span class="category-list-count">34</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/C-C-开发/">C/C++开发</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java开发/">Java开发</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux内核/">Linux内核</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/live555/">live555</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/业界趣闻/">业界趣闻</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/后台开发/">后台开发</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/安全/">安全</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络协议/">网络协议</a><span class="category-list-count">39</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络调试/">网络调试</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/随想杂谈/">随想杂谈</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/音视频开发/">音视频开发</a><span class="category-list-count">3</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/OpenGL/" style="font-size: 15px;">OpenGL</a> <a href="/tags/网络协议/" style="font-size: 15px;">网络协议</a> <a href="/tags/Android开发/" style="font-size: 15px;">Android开发</a> <a href="/tags/源码分析/" style="font-size: 15px;">源码分析</a> <a href="/tags/chromium/" style="font-size: 15px;">chromium</a> <a href="/tags/后台开发/" style="font-size: 15px;">后台开发</a> <a href="/tags/Java开发/" style="font-size: 15px;">Java开发</a> <a href="/tags/QUIC/" style="font-size: 15px;">QUIC</a> <a href="/tags/翻译/" style="font-size: 15px;">翻译</a> <a href="/tags/网络调试/" style="font-size: 15px;">网络调试</a> <a href="/tags/HTTP2/" style="font-size: 15px;">HTTP2</a> <a href="/tags/UDT/" style="font-size: 15px;">UDT</a> <a href="/tags/图形图像/" style="font-size: 15px;">图形图像</a> <a href="/tags/安全/" style="font-size: 15px;">安全</a> <a href="/tags/HTTPS/" style="font-size: 15px;">HTTPS</a> <a href="/tags/C-C-开发/" style="font-size: 15px;">C/C++开发</a> <a href="/tags/音视频开发/" style="font-size: 15px;">音视频开发</a> <a href="/tags/Linux内核/" style="font-size: 15px;">Linux内核</a> <a href="/tags/live555/" style="font-size: 15px;">live555</a> <a href="/tags/Django/" style="font-size: 15px;">Django</a> <a href="/tags/Go-语言/" style="font-size: 15px;">Go 语言</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-fei"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">十二月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">十月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/09/">九月 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/07/">七月 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/05/">五月 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/02/">二月 2013</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/09/04/live555_src_analysis_describe/">live555 源码分析： DESCRIBE 的处理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/03/live555_src_analysis_rtspserver/">live555 源码分析：RTSPServer</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/01/live555_src_analysis_rtsp_rtp_rtcp_wireshark/">Wireshark 抓包分析 RTSP/RTP/RTCP 基本工作过程</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/31/live555_src_analysis_mediaserver/">live555 源码分析：MediaSever</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/30/live555_src_analysis_infrasture/">live555 源码分析：基础设施</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/28/live555_src_analysis_introduction/">live555 源码分析：简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/24/h264_send_with_ortp/">使用 ortp 发送原始 H.264 码流</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/23/h264_play/">原始 H.264 码流播放</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/18/h264_on_rtp/">H.264 视频的 RTP 载荷格式</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/12/working/">从工作中得到了什么？</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> 友情链接</i></div><ul></ul><a href="https://developer.android.com/index.html" title="Android Developers" target="_blank">Android Developers</a><ul></ul><a href="https://source.android.com/" title="Android Open Source Project" target="_blank">Android Open Source Project</a><ul></ul><a href="http://www.vants.org/" title="蚂蚁网" target="_blank">蚂蚁网</a></div><div class="widget"><div class="widget-title"><i class="fa fa-commt"> 最近评论</i></div><script type="text/javascript" src="//wolfcstech.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div></div></div></div><a id="totop" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.2.0" async></script><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">网站地图</a> |<a href="/atom.xml">订阅本站</a> |<span>联系博主：<a href="mailto:hanpfei@gmail.com" target="_blank" class="fa fa-email"> </a><a href="undefined" target="_blank" class="fa fa-weibo"></a><a href="https://github.com/hanpfei" target="_blank" class="fa fa-github"> </a></span></p><p><span> Copyright &copy;<a href="/." rel="nofollow">Han Pengfei</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span><span><a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> Theme </a>by<a rel="nofollow" target="_blank" href="https://github.com/chaooo"> Charles.</a></span></p></div></div></div><script>var disqus_shortname = 'wolfcstech';
var disqus_identifier = '2016/11/16/ChromiumGN构建工具的使用/';
var disqus_title = 'Chromium GN构建工具的使用';
var disqus_url = 'https://www.wolfcstech.com/2016/11/16/ChromiumGN构建工具的使用/';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//wolfcstech.disqus.com/count.js" async></script><script type="text/javascript" src="/js/search.json.js?v=1.2.0"></script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?3c736b12c32c019fd9ff6c825b6b9b44";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();</script></body></html>