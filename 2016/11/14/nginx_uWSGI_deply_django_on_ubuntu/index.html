<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>基于nginx和uWSGI在Ubuntu上部署Django | WolfcsTech</title><link rel="stylesheet" type="text/css" href="//fonts.css.network/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.2.0"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=1.2.0"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">基于nginx和uWSGI在Ubuntu上部署Django</h1><a id="logo" href="/.">WolfcsTech</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">基于nginx和uWSGI在Ubuntu上部署Django</h1><div class="post-meta">Nov 14, 2016<span> | </span><span class="category"><a href="/categories/后台开发/">后台开发</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-disqus-identifier="2016/11/14/nginx_uWSGI_deply_django_on_ubuntu/" href="/2016/11/14/nginx_uWSGI_deply_django_on_ubuntu/#disqus_thread" class="disqus-comment-count"></a><div class="post-content"><h1 id="1-nginx"><a href="#1-nginx" class="headerlink" title="1. nginx"></a>1. nginx</h1><p>启动、停止和重启</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$ </span>nginx</div><div class="line"><span class="variable">$ </span>nginx -s stop</div><div class="line"><span class="variable">$ </span>nginx -s reload</div></pre></td></tr></table></figure>
<a id="more"></a>
<h1 id="2-uWSGI安装"><a href="#2-uWSGI安装" class="headerlink" title="2. uWSGI安装"></a>2. uWSGI安装</h1><p>用python的pip安装最简单：<br><figure class="highlight cmake"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">apt-get <span class="keyword">install</span> python-dev <span class="comment">#不安装这个，下面的安装可能会失败</span></div><div class="line">pip <span class="keyword">install</span> uwsgi</div></pre></td></tr></table></figure></p>
<h1 id="3-基于uWSGI和nginx部署Django"><a href="#3-基于uWSGI和nginx部署Django" class="headerlink" title="3. 基于uWSGI和nginx部署Django"></a>3. 基于uWSGI和nginx部署Django</h1><h2 id="1-原理"><a href="#1-原理" class="headerlink" title="1. 原理"></a>1. 原理</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Web Client <span class="tag">&lt;<span class="name">===</span>&gt;</span> Web Server(nginx) <span class="tag">&lt;<span class="name">===</span>&gt;</span> The Socket <span class="tag">&lt;<span class="name">===</span>&gt;</span> uWSGI <span class="tag">&lt;<span class="name">===</span>&gt;</span> Django</div></pre></td></tr></table></figure>
<h2 id="2-基本测试"><a href="#2-基本测试" class="headerlink" title="2.基本测试"></a>2.基本测试</h2><h3 id="测试uWSGI是否正常"><a href="#测试uWSGI是否正常" class="headerlink" title="测试uWSGI是否正常"></a>测试uWSGI是否正常</h3><p>在django项目的根目录下创建test.py文件，添加源码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># test.py</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">application</span><span class="params">(env, start_response)</span>:</span></div><div class="line">    start_response(<span class="string">'200 OK'</span>, [(<span class="string">'Content-Type'</span>,<span class="string">'text/html'</span>)])</div><div class="line">    <span class="keyword">return</span> [<span class="string">"Hello World"</span>] <span class="comment"># python2</span></div><div class="line">    <span class="comment">#return [b"Hello World"] # python3</span></div></pre></td></tr></table></figure>
<p>Django项目的创建方法，可参考<a href="https://my.oschina.net/wolfcs/blog/364715" target="_blank" rel="external">Django教程</a>。</p>
<p>然后，运行uWSGI:</p>
<figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">$</span> <span class="comment">uwsgi</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">http</span> <span class="comment">:8000</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">wsgi</span><span class="literal">-</span><span class="comment">file</span> <span class="comment">test</span><span class="string">.</span><span class="comment">py</span></div></pre></td></tr></table></figure>
<p>参数含义:</p>
<ul>
<li><code>http :8000</code>: 使用http协议，8000端口</li>
<li><code>wsgi-file test.py</code>: 加载指定文件 test.py</li>
</ul>
<p>用浏览器打开下面url，应该显示<code>hello world</code>字符串：<br><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="link">http://</span>[<span class="string">example.com</span>]:8000</div></pre></td></tr></table></figure></p>
<p>如果部署服务器的主机和运行浏览器的主机不是同一台，<code>[example.com]</code>要替换为部署服务器的主机实际的域名，若是同一台，<code>[example.com]</code>可以替换为localhost，如：<br><figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">http:</span><span class="comment">//localhost:8000</span></div></pre></td></tr></table></figure></p>
<p>如果显示正确，说明下面3个环节是通畅的：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Web Client <span class="tag">&lt;<span class="name">===</span>&gt;</span> uWSGI <span class="tag">&lt;<span class="name">===</span>&gt;</span> Python</div></pre></td></tr></table></figure>
<h3 id="测试Django项目是否正常"><a href="#测试Django项目是否正常" class="headerlink" title="测试Django项目是否正常"></a>测试Django项目是否正常</h3><p>首先确保 项目 本身是正常的：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ python manage<span class="selector-class">.py</span> runserver <span class="number">0.0</span>.<span class="number">0.0</span>:<span class="number">8000</span></div></pre></td></tr></table></figure></p>
<p>如果没问题，使用uWSGI把Project拉起来：<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ uwsgi --http <span class="symbol">:</span><span class="number">8000</span> --<span class="class"><span class="keyword">module</span> <span class="title">mysite</span>.<span class="title">wsgi</span></span></div></pre></td></tr></table></figure></p>
<ul>
<li><code>module mysite.wsgi</code>: 加载wsgi module。<code>mysite.wsgi</code>指向一个python模块，即<code>mysite</code>目录下名为<code>wsgi.py</code>的文件。新建出来的Django项目，它的这个文件的内容大体如下：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="string">"""</span></div><div class="line">WSGI config for mysite project.</div><div class="line"></div><div class="line">It exposes the WSGI callable as a module-level variable named ``application``.</div><div class="line"></div><div class="line">For more information on this file, see</div><div class="line">https://docs.djangoproject.com/en/1.10/howto/deployment/wsgi/</div><div class="line">"""</div><div class="line"></div><div class="line"><span class="keyword">import</span> os</div><div class="line"></div><div class="line"><span class="keyword">from</span> django.core.wsgi <span class="keyword">import</span> get_wsgi_application</div><div class="line"></div><div class="line">os.environ.setdefault(<span class="string">"DJANGO_SETTINGS_MODULE"</span>, <span class="string">"mysite.settings"</span>)</div><div class="line"></div><div class="line">application = get_wsgi_application()</div></pre></td></tr></table></figure>
<p>如果Project能够被正常拉起，说明以下环节是通的：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Web Client <span class="tag">&lt;<span class="name">===</span>&gt;</span> uWSGI <span class="tag">&lt;<span class="name">===</span>&gt;</span> Django</div></pre></td></tr></table></figure>
<h2 id="3-配置nginx"><a href="#3-配置nginx" class="headerlink" title="3.配置nginx"></a>3.配置nginx</h2><p>安装nginx完成后，如果能正常打开<a href="http://hostname，说明下面环节是通畅的：" target="_blank" rel="external">http://hostname，说明下面环节是通畅的：</a></p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Web <span class="built_in">Client</span> &lt;===&gt; Web <span class="built_in">Server</span>(nginx)</div></pre></td></tr></table></figure>
<h3 id="增加nginx配置"><a href="#增加nginx配置" class="headerlink" title="增加nginx配置"></a>增加nginx配置</h3><ul>
<li><p>将<code>uwsgi_params</code>文件拷贝到项目文件夹下。<code>uwsgi_params</code>文件在/etc/nginx/目录下，也可以从<a href="https://github.com/nginx/nginx/blob/master/conf/uwsgi_params" target="_blank" rel="external">这个页面</a>下载</p>
</li>
<li><p>在项目文件夹下创建文件mysite_nginx.conf，填入并修改下面内容：</p>
</li>
</ul>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"> mysite_nginx.conf</div><div class="line"></div><div class="line"><span class="comment"># the upstream component nginx needs to connect to</span></div><div class="line">upstream django &#123;</div><div class="line">    <span class="comment"># server unix:///home/www-data/www/mysite/mysite.sock; # for a file socket</span></div><div class="line">    server <span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">8001</span>; <span class="comment"># for a web port socket (we'll use this first)</span></div><div class="line">&#125;</div><div class="line"><span class="comment"># configuration of the server</span></div><div class="line">server &#123;</div><div class="line">    <span class="comment"># the port your site will be served on</span></div><div class="line">    listen      <span class="number">8000</span>;</div><div class="line">    <span class="comment"># the domain name it will serve for</span></div><div class="line">    server_name www.wolfcstech.com wolfcstech.com www.wolfcstech.cn wolfcstech.cn; <span class="comment"># substitute your machine's IP address or FQDN</span></div><div class="line">    charset     utf-<span class="number">8</span>;</div><div class="line"></div><div class="line">    <span class="comment"># max upload size</span></div><div class="line">    client_max_body_size <span class="number">75M</span>;   <span class="comment"># adjust to taste</span></div><div class="line"></div><div class="line">    <span class="comment"># Django media</span></div><div class="line">    <span class="keyword">location</span> <span class="title">/media</span>  &#123;</div><div class="line">        alias /home/www-data/www/mysite_data/media;  <span class="comment"># your Django project's media files - amend as required</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">location</span> <span class="title">/static</span> &#123;</div><div class="line">        alias /home/www-data/www/mysite/static; <span class="comment"># your Django project's static files - amend as required</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment"># Finally, send all non-media requests to the Django server.</span></div><div class="line">    <span class="keyword">location</span> <span class="title">/ &#123;</span></div><div class="line">        uwsgi_pass  django;</div><div class="line">        include     /home/www-data/www/mysite/uwsgi_params; <span class="comment"># the uwsgi_params file you installed</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这个配置文件的写法就像常规的nginx配置文件<code>/usr/local/nginx/conf/nginx.conf</code>一样。这个配置文件告诉nginx，请求的资源的路径模式满足<code>/media/*</code>和<code>/static/*</code>的，要在文件系统中找。</p>
<p>在<code>/etc/nginx/sites-enabled</code>目录下创建该文件的符号连接，使nginx能够使用它：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo ln -s <span class="regexp">/home/</span>www-data<span class="regexp">/www/my</span>site<span class="regexp">/mysite_nginx.conf /</span>etc<span class="regexp">/nginx/</span>sites-enabled<span class="regexp">/</span></div></pre></td></tr></table></figure>
<h3 id="部署static文件"><a href="#部署static文件" class="headerlink" title="部署static文件"></a>部署static文件</h3><p>在Django项目的<code>mysite/settings.py</code>文件中文件末尾，添加下面一行内容：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">STATIC_ROOT = os<span class="selector-class">.path</span><span class="selector-class">.join</span>(BASE_DIR, <span class="string">"static/"</span>)</div></pre></td></tr></table></figure>
<p>然后运行：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ python manage<span class="selector-class">.py</span> collectstatic</div></pre></td></tr></table></figure>
<p>Django框架在创建项目时，默认提供了admin等接口，这会将Django框架中这些接口用到的一些静态文件，js，css等文件，拷贝到项目的static目录下，如：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">root@iZuf6gttapr078fb1vrh8uZ:/home/www-data/www/mysite# python manage<span class="variable">.py</span> collectstatic</div><div class="line"></div><div class="line">You have requested to collect <span class="keyword">static</span> files at the destination</div><div class="line">location as specified in your settings:</div><div class="line"></div><div class="line">    /home/www-data/www/mysite/<span class="keyword">static</span></div><div class="line"></div><div class="line">This will overwrite existing files!</div><div class="line">Are you sure you want to <span class="keyword">do</span> <span class="keyword">this</span>?</div><div class="line"></div><div class="line">Type 'yes' to <span class="keyword">continue</span>, <span class="keyword">or</span> 'no' to cancel: yes</div><div class="line">Copying '/usr/<span class="keyword">local</span>/lib/python2<span class="variable">.7</span>/<span class="keyword">dist</span>-packages/django/contrib/admin/<span class="keyword">static</span>/admin/js/collapse<span class="variable">.js</span>'</div><div class="line">Copying '/usr/<span class="keyword">local</span>/lib/python2<span class="variable">.7</span>/<span class="keyword">dist</span>-packages/django/contrib/admin/<span class="keyword">static</span>/admin/js/timeparse<span class="variable">.js</span>'</div><div class="line">Copying '/usr/<span class="keyword">local</span>/lib/python2<span class="variable">.7</span>/<span class="keyword">dist</span>-packages/django/contrib/admin/<span class="keyword">static</span>/admin/js/popup_response<span class="variable">.js</span>'</div><div class="line">Copying '/usr/<span class="keyword">local</span>/lib/python2<span class="variable">.7</span>/<span class="keyword">dist</span>-packages/django/contrib/admin/<span class="keyword">static</span>/admin/js/SelectFilter2<span class="variable">.js</span>'</div><div class="line">Copying '/usr/<span class="keyword">local</span>/lib/python2<span class="variable">.7</span>/<span class="keyword">dist</span>-packages/django/contrib/admin/<span class="keyword">static</span>/admin/js/jquery<span class="variable">.init</span><span class="variable">.js</span>'</div><div class="line">Copying '/usr/<span class="keyword">local</span>/lib/python2<span class="variable">.7</span>/<span class="keyword">dist</span>-packages/django/contrib/admin/<span class="keyword">static</span>/admin/js/collapse<span class="variable">.min</span><span class="variable">.js</span>'</div><div class="line">Copying '/usr/<span class="keyword">local</span>/lib/python2<span class="variable">.7</span>/<span class="keyword">dist</span>-packages/django/contrib/admin/<span class="keyword">static</span>/admin/js/inlines<span class="variable">.min</span><span class="variable">.js</span>'</div><div class="line">Copying '/usr/<span class="keyword">local</span>/lib/python2<span class="variable">.7</span>/<span class="keyword">dist</span>-packages/django/contrib/admin/<span class="keyword">static</span>/admin/js/calendar<span class="variable">.js</span>'</div><div class="line">Copying '/usr/<span class="keyword">local</span>/lib/python2<span class="variable">.7</span>/<span class="keyword">dist</span>-packages/django/contrib/admin/<span class="keyword">static</span>/admin/js/SelectBox<span class="variable">.js</span>'</div><div class="line">Copying '/usr/<span class="keyword">local</span>/lib/python2<span class="variable">.7</span>/<span class="keyword">dist</span>-packages/django/contrib/admin/<span class="keyword">static</span>/admin/js/urlify<span class="variable">.js</span>'</div><div class="line">Copying '/usr/<span class="keyword">local</span>/lib/python2<span class="variable">.7</span>/<span class="keyword">dist</span>-packages/django/contrib/admin/<span class="keyword">static</span>/admin/js/prepopulate_init<span class="variable">.js</span>'</div><div class="line">Copying '/usr/<span class="keyword">local</span>/lib/python2<span class="variable">.7</span>/<span class="keyword">dist</span>-packages/django/contrib/admin/<span class="keyword">static</span>/admin/js/change_form<span class="variable">.js</span>'</div><div class="line">Copying '/usr/<span class="keyword">local</span>/lib/python2<span class="variable">.7</span>/<span class="keyword">dist</span>-packages/django/contrib/admin/<span class="keyword">static</span>/admin/js/cancel<span class="variable">.js</span>'</div><div class="line">Copying '/usr/<span class="keyword">local</span>/lib/python2<span class="variable">.7</span>/<span class="keyword">dist</span>-packages/django/contrib/admin/<span class="keyword">static</span>/admin/js/prepopulate<span class="variable">.min</span><span class="variable">.js</span>'</div><div class="line">Copying '/usr/<span class="keyword">local</span>/lib/python2<span class="variable">.7</span>/<span class="keyword">dist</span>-packages/django/contrib/admin/<span class="keyword">static</span>/admin/js/actions<span class="variable">.min</span><span class="variable">.js</span>'</div><div class="line">Copying '/usr/<span class="keyword">local</span>/lib/python2<span class="variable">.7</span>/<span class="keyword">dist</span>-packages/django/contrib/admin/<span class="keyword">static</span>/admin/js/core<span class="variable">.js</span>'</div><div class="line">Copying '/usr/<span class="keyword">local</span>/lib/python2<span class="variable">.7</span>/<span class="keyword">dist</span>-packages/django/contrib/admin/<span class="keyword">static</span>/admin/js/prepopulate<span class="variable">.js</span>'</div><div class="line">Copying '/usr/<span class="keyword">local</span>/lib/python2<span class="variable">.7</span>/<span class="keyword">dist</span>-packages/django/contrib/admin/<span class="keyword">static</span>/admin/js/actions<span class="variable">.js</span>'</div><div class="line">Copying '/usr/<span class="keyword">local</span>/lib/python2<span class="variable">.7</span>/<span class="keyword">dist</span>-packages/django/contrib/admin/<span class="keyword">static</span>/admin/js/inlines<span class="variable">.js</span>'</div><div class="line">Copying '/usr/<span class="keyword">local</span>/lib/python2<span class="variable">.7</span>/<span class="keyword">dist</span>-packages/django/contrib/admin/<span class="keyword">static</span>/admin/js/vendor/jquery/LICENSE-JQUERY<span class="variable">.txt</span>'</div><div class="line">......</div></pre></td></tr></table></figure>
<h3 id="测试nginx"><a href="#测试nginx" class="headerlink" title="测试nginx"></a>测试nginx</h3><p>首先重启nginx服务：</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$ </span>nginx -s stop</div><div class="line"><span class="variable">$ </span>nginx</div></pre></td></tr></table></figure>
<p>然后检查media文件是否已经可以正常访问：</p>
<p>在目录/path/to/your/project/project/media directory下添加文件meida.png，然后访问<a href="http://example.com:8000/media/media.png" target="_blank" rel="external">http://example.com:8000/media/media.png</a> ，成功后进行下一步测试。</p>
<h2 id="4-nginx、uWSGI和test-py"><a href="#4-nginx、uWSGI和test-py" class="headerlink" title="4.nginx、uWSGI和test.py"></a>4.nginx、uWSGI和test.py</h2><p>执行下面代码测试能否让nginx在页面上显示<code>hello, world</code></p>
<figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">uwsgi</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">socket</span> <span class="comment">:8001</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">wsgi</span><span class="literal">-</span><span class="comment">file</span> <span class="comment">test</span><span class="string">.</span><span class="comment">py</span></div></pre></td></tr></table></figure>
<p>访问<a href="http://example.com:8000，如果显示`hello" target="_blank" rel="external">http://example.com:8000，如果显示`hello</a> world`，则说明下面环节是通畅的:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Web Client <span class="tag">&lt;<span class="name">===</span>&gt;</span> Web Server(nginx) <span class="tag">&lt;<span class="name">===</span>&gt;</span> The Socket <span class="tag">&lt;<span class="name">===</span>&gt;</span> uWSGI <span class="tag">&lt;<span class="name">===</span>&gt;</span> Python</div></pre></td></tr></table></figure>
<h3 id="用UNIX-socket取代TCP-port"><a href="#用UNIX-socket取代TCP-port" class="headerlink" title="用UNIX socket取代TCP port"></a>用UNIX socket取代TCP port</h3><p>对mysite_nginx.conf做如下修改：</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">server <span class="symbol">unix:</span>/<span class="regexp">//home</span><span class="regexp">/www-data/www</span><span class="regexp">/mysite/mysite</span>.sock; <span class="comment"># for a file socket</span></div><div class="line"><span class="comment"># server 127.0.0.1:8001; # for a web port socket (we'll use this first)</span></div></pre></td></tr></table></figure>
<p>重启nginx，并再次运行uWSGI：</p>
<figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">uwsgi</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">socket</span> <span class="comment">mysite</span><span class="string">.</span><span class="comment">sock</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">wsgi</span><span class="literal">-</span><span class="comment">file</span> <span class="comment">test</span><span class="string">.</span><span class="comment">py</span></div></pre></td></tr></table></figure>
<p>打开 <a href="http://example.com:8000/" target="_blank" rel="external">http://example.com:8000/</a> ，看看是否成功。</p>
<h3 id="如果没有成功"><a href="#如果没有成功" class="headerlink" title="如果没有成功"></a>如果没有成功</h3><p>检查 nginx error log (/var/log/nginx/error.log)。如果错误如下：</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="title">connect</span>() to unix:///home/www-<span class="class"><span class="keyword">data</span>/www/mysite/mysite.sock failed (13: <span class="type">Permission</span> <span class="title">denied</span>)</span></div></pre></td></tr></table></figure>
<p>访问Django应用的接口，报出502 Bad Gateway错误：</p>
<p><img src="https://www.wolfcstech.com/images/badgateway.png" alt="Bad Gateway"></p>
<p>则添加socket权限再次运行：</p>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">uwsgi </span><span class="built_in">--socket</span> <span class="string">mysite.</span><span class="string">sock </span><span class="built_in">--wsgi-file</span> <span class="string">test.</span><span class="string">py </span><span class="built_in">--chmod-socket=666</span> <span class="comment"># (very permissive)</span></div></pre></td></tr></table></figure>
<p>or<br><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">uwsgi </span><span class="built_in">--socket</span> <span class="string">mysite.</span><span class="string">sock </span><span class="built_in">--wsgi-file</span> <span class="string">test.</span><span class="string">py </span><span class="built_in">--chmod-socket=664</span> <span class="comment"># (more sensible)</span></div></pre></td></tr></table></figure></p>
<h2 id="5-基于uWSGI和nginx运行Django应用"><a href="#5-基于uWSGI和nginx运行Django应用" class="headerlink" title="5. 基于uWSGI和nginx运行Django应用"></a>5. 基于uWSGI和nginx运行Django应用</h2><p>如果上面一切都显示正常，则下面命令可以拉起D<br>jango应用：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">uwsgi --socket mysite<span class="selector-class">.sock</span> --module mysite<span class="selector-class">.wsgi</span> --chmod-socket=<span class="number">666</span></div></pre></td></tr></table></figure>
<p>这里的权限同样要注意，就如同上面测试的那样。</p>
<h3 id="用-ini文件配置uWSGI"><a href="#用-ini文件配置uWSGI" class="headerlink" title="用.ini文件配置uWSGI"></a>用.ini文件配置uWSGI</h3><p>每次都运行上面命令拉起Django应用实在麻烦，使用.ini文件能简化工作，方法如下：</p>
<p>在应用目录下创建文件<code>mysite_uwsgi.ini</code>，填入并修改下面内容：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># mysite_uwsgi.ini file</span></div><div class="line"><span class="section">[uwsgi]</span></div><div class="line"></div><div class="line"><span class="comment"># Django-related settings</span></div><div class="line"><span class="comment"># the base directory (full path)</span></div><div class="line"><span class="attr">chdir</span>           = /home/www-data/www/mysite</div><div class="line"><span class="comment"># Django's wsgi file</span></div><div class="line"><span class="attr">module</span>          = mysite.wsgi</div><div class="line"><span class="comment"># the virtualenv (full path)</span></div><div class="line"><span class="comment"># home            = /path/to/virtualenv</span></div><div class="line"></div><div class="line"><span class="comment"># process-related settings</span></div><div class="line"><span class="comment"># master</span></div><div class="line"><span class="attr">master</span>          = <span class="literal">true</span></div><div class="line"><span class="comment"># maximum number of worker processes</span></div><div class="line"><span class="attr">processes</span>       = <span class="number">10</span></div><div class="line"><span class="comment"># the socket (use the full path to be safe</span></div><div class="line"><span class="attr">socket</span>          = /home/www-data/www/mysite/mysite.sock</div><div class="line"><span class="comment"># ... with appropriate permissions - may be needed</span></div><div class="line"><span class="attr">chmod-socket</span>    = <span class="number">666</span></div><div class="line"><span class="comment"># clear environment on exit</span></div><div class="line"><span class="attr">vacuum</span>          = <span class="literal">true</span></div></pre></td></tr></table></figure>
<p>现在，只要执行以下命令，就能够拉起django应用：</p>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">uwsgi </span><span class="built_in">--ini</span> <span class="string">mysite_uwsgi.</span><span class="string">ini </span><span class="comment"># the --ini option is used to specify a file</span></div></pre></td></tr></table></figure>
<h3 id="检查配置"><a href="#检查配置" class="headerlink" title="检查配置"></a>检查配置</h3><p>最后，通过访问Django提供的接口接口服务，检查上面的所有配置，如在浏览器中输入<code>http://www.wolfcstech.com:8000/admin</code>，应该可以看到如下的页面：</p>
<p><img src="https://www.wolfcstech.com/images/djang_admin.png" alt="Django admin page"></p>
<h3 id="uWSGI后台运行"><a href="#uWSGI后台运行" class="headerlink" title="uWSGI后台运行"></a>uWSGI后台运行</h3><p>前面介绍的uWSGI运行方式是在终端前台运行，终端关闭的话，uWSGI进程也都会跟着结束掉。可我们也不能总是为uWSGI开一个终端啊。我们可以配置uWSGI后台运行。需要在mysite_uwsgi.ini配置文件中添加：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">daemonize = <span class="regexp">/home/</span>www-data<span class="regexp">/www/</span>web_application_log<span class="regexp">/uwsgi.log</span></div></pre></td></tr></table></figure>
<p>这样就会把日志打印到uwsgi.log中。</p>
<h3 id="使uWSGI在系统启动时启动"><a href="#使uWSGI在系统启动时启动" class="headerlink" title="使uWSGI在系统启动时启动"></a>使uWSGI在系统启动时启动</h3><p>编辑文件/etc/rc.local, 添加下面内容到这行代码之前exit 0:</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="regexp">/usr/</span>local<span class="regexp">/bin/u</span>wsgi --socket <span class="regexp">/home/</span>www-data<span class="regexp">/www/my</span>site<span class="regexp">/mysite.sock --module /</span>home<span class="regexp">/www-data/</span>www<span class="regexp">/mysite/my</span>site.wsgi --chmod-socket=<span class="number">666</span></div></pre></td></tr></table></figure>
<h3 id="uWSGI的更多配置"><a href="#uWSGI的更多配置" class="headerlink" title="uWSGI的更多配置"></a>uWSGI的更多配置</h3><figure class="highlight nix"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="attr">env</span> = <span class="attr">DJANGO_SETTINGS_MODULE=mysite.settings</span> <span class="comment"># set an environment variable</span></div><div class="line"><span class="attr">pidfile</span> = /tmp/project-master.pid <span class="comment"># create a pidfile</span></div><div class="line"><span class="attr">harakiri</span> = <span class="number">20</span> <span class="comment"># respawn processes taking more than 20 seconds</span></div><div class="line"><span class="attr">limit-as</span> = <span class="number">128</span> <span class="comment"># limit the project to 128 MB</span></div><div class="line"><span class="attr">max-requests</span> = <span class="number">5000</span> <span class="comment"># respawn processes after serving 5000 requests</span></div><div class="line"><span class="attr">daemonize</span> = /var/log/uwsgi/yourproject.log <span class="comment"># background the process &amp; log</span></div></pre></td></tr></table></figure>
<h2 id="7-Django文件上传接口"><a href="#7-Django文件上传接口" class="headerlink" title="7. Django文件上传接口"></a>7. Django文件上传接口</h2><p>这部分展示一个示例的Django接口。该接口主要用于验证前面的配置。而接口的功能则主要是处理文件上传。</p>
<h3 id="配置url模式"><a href="#配置url模式" class="headerlink" title="配置url模式"></a>配置url模式</h3><p>在mysite/urls.py中为文件上传接口配置url模式：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> url</div><div class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</div><div class="line"></div><div class="line"><span class="keyword">import</span> uploader</div><div class="line"></div><div class="line">urlpatterns = [</div><div class="line">    url(<span class="string">r'^upload'</span>, uploader.upload),</div><div class="line">    url(<span class="string">r'^admin/'</span>, admin.site.urls),</div><div class="line">]</div></pre></td></tr></table></figure>
<h3 id="实现上传接口"><a href="#实现上传接口" class="headerlink" title="实现上传接口"></a>实现上传接口</h3><p>文件上传接口的实现如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/python</span></div><div class="line"></div><div class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</div><div class="line"><span class="keyword">from</span> django.views.decorators.csrf <span class="keyword">import</span> csrf_exempt</div><div class="line"><span class="keyword">from</span> django <span class="keyword">import</span> forms</div><div class="line"></div><div class="line"><span class="keyword">import</span> hashlib</div><div class="line"><span class="keyword">import</span> json</div><div class="line"><span class="keyword">import</span> os</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">NormalUserForm</span><span class="params">(forms.Form)</span>:</span></div><div class="line">  username = forms.CharField()</div><div class="line">  headImg = forms.FileField()</div><div class="line"></div><div class="line">dir_path = <span class="string">"/home/www-data/www/mysite_data/uploaded_files"</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">cal_md5</span><span class="params">(diff_file_name)</span>:</span></div><div class="line">    md5 = hashlib.md5()</div><div class="line">    diff_file = open(diff_file_name, <span class="string">'rb'</span>)</div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        data = diff_file.read(<span class="number">8192</span>)</div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> data:</div><div class="line">            <span class="keyword">break</span></div><div class="line"></div><div class="line">        md5.update(data)</div><div class="line">    md5_value = md5.hexdigest()</div><div class="line">    <span class="keyword">return</span> md5_value</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">handle_uploaded_file</span><span class="params">(file)</span>:</span></div><div class="line">    filename = os.path.join(dir_path, file.name)</div><div class="line">    <span class="keyword">print</span> <span class="string">"filename = "</span> + filename</div><div class="line">    <span class="keyword">with</span> open(filename, <span class="string">'wb+'</span>) <span class="keyword">as</span> destination:</div><div class="line">        <span class="keyword">for</span> chunk <span class="keyword">in</span> file.chunks():</div><div class="line">            destination.write(chunk)</div><div class="line">    <span class="keyword">return</span> cal_md5(filename)</div><div class="line"></div><div class="line"><span class="meta">@csrf_exempt</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">upload</span><span class="params">(request)</span>:</span></div><div class="line">    md5 = <span class="string">""</span></div><div class="line">    <span class="keyword">if</span> request.method == <span class="string">'POST'</span>:</div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            files = request.FILES.getlist(<span class="string">'file'</span>)</div><div class="line">            <span class="keyword">for</span> file <span class="keyword">in</span> files:</div><div class="line">                md5 += handle_uploaded_file(file)</div><div class="line">        <span class="keyword">except</span> Exception,e:</div><div class="line">            <span class="keyword">print</span> str(e)</div><div class="line"></div><div class="line">        <span class="keyword">if</span> md5 == <span class="string">""</span>:</div><div class="line">            hash_md5 = hashlib.md5(request.body)</div><div class="line">            md5 = hash_md5.hexdigest()</div><div class="line"></div><div class="line">        data1 = &#123;<span class="string">'md5'</span>:md5&#125;</div><div class="line">        md5 = json.dumps(data1,sort_keys=<span class="keyword">True</span>,indent=<span class="number">4</span>)</div><div class="line">        <span class="keyword">print</span> <span class="string">"md5 = "</span> + str(md5)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> HttpResponse(md5)</div></pre></td></tr></table></figure>
<p>这个接口将文件保存在由dir_path定义的文件夹下，同时计算文件的md5，返回给客户端。</p>
<h1 id="4-参考文档"><a href="#4-参考文档" class="headerlink" title="4. 参考文档"></a>4. 参考文档</h1><p><a href="http://www.jianshu.com/p/e6ff4a28ab5a" target="_blank" rel="external">基于nginx和uWSGI在Ubuntu上部署Django</a></p>
<p><a href="https://segmentfault.com/q/1010000002523354" target="_blank" rel="external">uwsgi后台运行</a></p>
<p><a href="http://uwsgi-docs-cn.readthedocs.io/zh_CN/latest/WSGIquickstart.html" target="_blank" rel="external">Python/WSGI 应用快速入门</a></p>
<p><a href="http://uwsgi-docs-cn.readthedocs.io/zh_CN/latest/index.html" target="_blank" rel="external">The uWSGI project</a></p>
</div><div class="tags"><a href="/tags/后台开发/">后台开发</a><a href="/tags/Django/">Django</a></div><div class="post-nav"><a href="/2016/11/14/curl_for_HTTP2_on_ubuntu/" class="pre">为curl命令启用HTTP2支持</a><a href="/2016/11/13/Netty-HTTP-on-Android/" class="next">Netty HTTP on Android</a></div><div id="disqus_thread"></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="widget"><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="请输入关键字..."/></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android开发/">Android开发</a><span class="category-list-count">34</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/C-C-开发/">C/C++开发</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java开发/">Java开发</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux内核/">Linux内核</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/live555/">live555</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/业界趣闻/">业界趣闻</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/后台开发/">后台开发</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/安全/">安全</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络协议/">网络协议</a><span class="category-list-count">39</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络调试/">网络调试</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/随想杂谈/">随想杂谈</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/音视频开发/">音视频开发</a><span class="category-list-count">3</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/OpenGL/" style="font-size: 15px;">OpenGL</a> <a href="/tags/网络协议/" style="font-size: 15px;">网络协议</a> <a href="/tags/Android开发/" style="font-size: 15px;">Android开发</a> <a href="/tags/源码分析/" style="font-size: 15px;">源码分析</a> <a href="/tags/chromium/" style="font-size: 15px;">chromium</a> <a href="/tags/后台开发/" style="font-size: 15px;">后台开发</a> <a href="/tags/Java开发/" style="font-size: 15px;">Java开发</a> <a href="/tags/QUIC/" style="font-size: 15px;">QUIC</a> <a href="/tags/翻译/" style="font-size: 15px;">翻译</a> <a href="/tags/网络调试/" style="font-size: 15px;">网络调试</a> <a href="/tags/HTTP2/" style="font-size: 15px;">HTTP2</a> <a href="/tags/UDT/" style="font-size: 15px;">UDT</a> <a href="/tags/图形图像/" style="font-size: 15px;">图形图像</a> <a href="/tags/安全/" style="font-size: 15px;">安全</a> <a href="/tags/HTTPS/" style="font-size: 15px;">HTTPS</a> <a href="/tags/C-C-开发/" style="font-size: 15px;">C/C++开发</a> <a href="/tags/音视频开发/" style="font-size: 15px;">音视频开发</a> <a href="/tags/Linux内核/" style="font-size: 15px;">Linux内核</a> <a href="/tags/live555/" style="font-size: 15px;">live555</a> <a href="/tags/Django/" style="font-size: 15px;">Django</a> <a href="/tags/Go-语言/" style="font-size: 15px;">Go 语言</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-fei"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">十二月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">十月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/09/">九月 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/07/">七月 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/05/">五月 2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/02/">二月 2013</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/09/04/live555_src_analysis_describe/">live555 源码分析： DESCRIBE 的处理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/03/live555_src_analysis_rtspserver/">live555 源码分析：RTSPServer</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/01/live555_src_analysis_rtsp_rtp_rtcp_wireshark/">Wireshark 抓包分析 RTSP/RTP/RTCP 基本工作过程</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/31/live555_src_analysis_mediaserver/">live555 源码分析：MediaSever</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/30/live555_src_analysis_infrasture/">live555 源码分析：基础设施</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/28/live555_src_analysis_introduction/">live555 源码分析：简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/24/h264_send_with_ortp/">使用 ortp 发送原始 H.264 码流</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/23/h264_play/">原始 H.264 码流播放</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/18/h264_on_rtp/">H.264 视频的 RTP 载荷格式</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/12/working/">从工作中得到了什么？</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> 友情链接</i></div><ul></ul><a href="https://developer.android.com/index.html" title="Android Developers" target="_blank">Android Developers</a><ul></ul><a href="https://source.android.com/" title="Android Open Source Project" target="_blank">Android Open Source Project</a><ul></ul><a href="http://www.vants.org/" title="蚂蚁网" target="_blank">蚂蚁网</a></div><div class="widget"><div class="widget-title"><i class="fa fa-commt"> 最近评论</i></div><script type="text/javascript" src="//wolfcstech.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div></div></div></div><a id="totop" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.2.0" async></script><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">网站地图</a> |<a href="/atom.xml">订阅本站</a> |<span>联系博主：<a href="mailto:hanpfei@gmail.com" target="_blank" class="fa fa-email"> </a><a href="undefined" target="_blank" class="fa fa-weibo"></a><a href="https://github.com/hanpfei" target="_blank" class="fa fa-github"> </a></span></p><p><span> Copyright &copy;<a href="/." rel="nofollow">Han Pengfei</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span><span><a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> Theme </a>by<a rel="nofollow" target="_blank" href="https://github.com/chaooo"> Charles.</a></span></p></div></div></div><script>var disqus_shortname = 'wolfcstech';
var disqus_identifier = '2016/11/14/nginx_uWSGI_deply_django_on_ubuntu/';
var disqus_title = '基于nginx和uWSGI在Ubuntu上部署Django';
var disqus_url = 'https://www.wolfcstech.com/2016/11/14/nginx_uWSGI_deply_django_on_ubuntu/';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//wolfcstech.disqus.com/count.js" async></script><script type="text/javascript" src="/js/search.json.js?v=1.2.0"></script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?3c736b12c32c019fd9ff6c825b6b9b44";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();</script></body></html>